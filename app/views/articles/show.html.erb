<script>
    function saveExternalArticleClick(articleId, articleURL) {
    	$.ajax({
	      type: "PUT",
	      url: "/save_visit/" + articleId
	    });
	    //open new link
	    window.open(articleURL,'_blank');
    }
    
    function userArticleSave(elem, articleId) {
        <% if !logged_in? %>
            window.open('/login', '_self');
        <% else %>
            $.ajax({
                type: "PUT",
                url: "/user_article_save/" + articleId
	        });
        <% end %>
    }
</script>

<style>
    /*
        social sharing?
        Code from here: https://simplesharingbuttons.com/#code
    */
    /*ul.share-buttons{*/
    /*    list-style: none;*/
    /*    padding: 0;*/
    /*}*/
    
    /*ul.share-buttons li{*/
    /*    display: inline;*/
    /*}*/
    
    /*ul.share-buttons .sr-only {*/
    /*    position: absolute;*/
    /*    clip: rect(1px 1px 1px 1px);*/
    /*    clip: rect(1px, 1px, 1px, 1px);*/
    /*    padding: 0;*/
    /*    border: 0;*/
    /*    height: 1px;*/
    /*    width: 1px;*/
    /*    overflow: hidden;*/
    /*}*/
    
</style>

<!-- Start page content -->
<div id="page-content" class="page-wrapper">
    <div class="zm-section single-post-wrap bg-white ptb-70 xs-pt-30">
        <div class="container">
            <div class="row">
                <!-- Start left side -->
                <div class="col-xs-12 col-sm-12 col-md-8 col-lg-8 columns">
                    <div class="row mb-40">
                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                            <div class="section-title">
				                
				                <% @article.states.each do |state| %>
				                    <h2 class="h6 header-color inline-block uppercase"><a href="<%=state_path(state)%>"><%=state.name%></a></h2>
				                <% end %>
                                <% @article.categories.each do |category| %>
                            		<h2 class="h6 header-color inline-block uppercase"><a href="<%=category_path(category)%>"><%=category.name%></a></h2>
				                <% end %>

                            </div>
                                <div class="entry-meta-small clearfix mtb-20">
                                    <div>
                                        
                                        <label class="switch pull-right">
                                            <!--check if article is already saved-->
                                            <% if current_user && UserArticle.where(:article_id => @article.id, :user_id => current_user.id, :saved => true).any? %>
                                                <input type="checkbox" checked onclick="userArticleSave(this, <%=@article.id%>);">
                                            <% else %>
                                                <input type="checkbox" unchecked onclick="userArticleSave(this, <%=@article.id%>);"> 
                                            <% end %>
                                        
                                            <div class="slider round" ></div> 
                                        </label>  
                                                                                            
                                    </div>
                                    <div class="meta-list pull-right">
                                        <span class="post-title">SAVE THIS ARTICLE:</span> 
                                    </div>
                                </div>                                    
                        </div>
                    </div>
                    <div class="row">
                        <!-- Start single post image formate-->
                        <div class="col-md-12">
                            <article class="zm-post-lay-single">
                                <div class="zm-post-thumb">
                                	<img src="<%=@article.image%>" onerror="this.src='<%= asset_path 'homepage/news-substitute.jpg' %>'" alt="">
                                </div>
                                <div class="zm-post-dis">
                                    <div class="zm-post-header">
                                        <h2 class="zm-post-title h2"><%=@article.title%></h2>
                                        <div class="zm-post-meta">
                                            <ul>
                                                <li class="s-meta"><a href="<%= source_path(@article.source) %>" class="zm-author"><%=@article.source.name%></a></li>
                                                <li class="s-meta"><%= @article.created_at.strftime("%B %d, %Y | %I:%M %p") %></li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="zm-post-content">
                                        <%= simple_format(@article.body) %>
                                    </div>
                                    <div class="entry-meta-small clearfix ptb-40 mtb-40 border-top border-bottom">
                                        <div>
                                            <label class="switch pull-right">
                                                <!--check if article is already saved-->
                                                <% if current_user && UserArticle.where(:article_id => @article.id, :user_id => current_user.id, :saved => true).any? %>
                                                    <input type="checkbox" checked onclick="userArticleSave(this, <%=@article.id%>);">
                                                <% else %>
                                                    <input type="checkbox" unchecked onclick="userArticleSave(this, <%=@article.id%>);"> 
                                                <% end %>
                                              <div class="slider round"></div>
                                            </label>                                                    
                                        </div>
                                        <div class="meta-list pull-right">
                                            <span class="post-title">SAVE THIS ARTICLE:</span> 
                                        </div> 
                                         <div class="share-social-link pull-left" style="margin-top: 5px;">
                                            <a href="https://twitter.com/share" class="twitter-share-button" data-show-count="false" target="_blank">
                                                Tweet
                                            </a>
                                            <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
                                        	
                                        	<!--<div class="fb-share-button" data-href="https://developers.facebook.com/docs/plugins/" data-layout="button" -->
                                        	<!--    data-size="small" data-mobile-iframe="true">-->
                                        	<!--        <a class="fb-xfbml-parse-ignore" target="_blank" -->
                                        	<!--            href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdevelopers.facebook.com%2Fdocs%2Fplugins%2F&amp;src=sdkpreparse">Share</a>-->
                                        	<!--</div>-->
                                        </div>
                                    </div>
                                </div>
                            </article>
                        </div>
                        <!-- End single post image formate -->

                        <!--Start Similar post -->
                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                            <aside class="zm-post-lay-a2-area">
                                <div class="row">
                                    <div class="col-xs-12">
                                        <div class="post-title mb-40">
                                            <h2 class="h6 inline-block">Other Posts By <%= @article.source.name %></h2>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="zm-posts clearfix">
                                        
                                        <!--loop through @same_source_articles -->
                                        <% @same_source_articles.each do |article| %>
                                        
                                            <div class="col-xs-12 col-sm-6 col-md-6 col-lg-4">
                                                <article class="zm-post-lay-a2">
                                                    <div class="zm-post-thumb">
                                                        <a href="<%= article_path(article) %>">
                                                            <img src="<%=article.image%>" onerror="this.src='<%= asset_path 'homepage/news-substitute.jpg' %>'" alt="">
                                                        </a>
                                                    </div>
                                                    <div class="zm-post-dis">
                                                        <div class="zm-post-header">
                                                            <h2 class="zm-post-title h2"><%= link_to article.title.truncate(60), article_path(article)%></h2>
                                                            <div class="zm-post-meta">
                                                                <ul>
                                                                    <li class="s-meta"><%= link_to article.source.name, article_path(article), class: 'zm-author'%></li>
                                                                    <li class="s-meta" style = "float: right;"><%= link_to article.created_at.strftime("%B %d, %Y"), article_path(article), class: 'zm-date'%></li>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </article>
                                            </div>
                                            
                                        <% end %>
                                        <!--loop through @same_source_articles-->
                                        
                                    </div>
                                </div>
                            </aside>
                        </div>
                        <!-- End similar post -->

                    </div>
                </div>
                <!-- End left side -->
                <!-- Start Right sidebar -->
                <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4 sidebar-warp columns">
                    <div class="row">
                        <aside class="zm-post-lay-a-area col-sm-6 col-md-12 col-lg-12 sm-mt-50 xs-mt-50">
                            <div class="row mb-40">
                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                                    <div class="section-title">
                                         <h2 class="h6 header-color inline-block uppercase">Related Articles</h2> 
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                
                                <!--loop through related articles-->
                                <% @related_articles.each do |article| %>
                                
                                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                                        <div class="zm-posts">
                                            <article class="zm-post-lay-a sidebar">
                                                <div class="zm-post-thumb">
                                                    <a href="<%= article_path(article) %>">
                                                        <img src="<%=article.image%>" onerror="this.src='<%= asset_path 'homepage/news-substitute.jpg' %>'" alt="">
                                                    </a>
                                                </div>
                                                <div class="zm-post-dis">
                                                    <div class="zm-post-header">
                                                        <h2 class="zm-post-title h2"><%= link_to article.title.truncate(60), article_path(article)%></h2>
                                                        <div class="zm-post-meta" style="margin-bottom: 15px;">
                                                            <ul>
                                                                <li class="s-meta"><%= link_to article.source.name, article_path(article), class: 'zm-author'%></li>
                                                                <li class="s-meta" style = "float: right;"><%= link_to article.created_at.strftime("%B %d, %Y"), article_path(article), class: 'zm-date'%></li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                            </article>
                                        </div>
                                    </div>
                                <% end %>
                                <!--loop through related articles-->
                            </div>
                        </aside>
                        
                    </div>
                </div>
                <!-- End Right sidebar -->
            </div>
        </div>
    </div>
</div>
<!-- End page content
